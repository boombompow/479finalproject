<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><!-- InstanceBegin template="/Templates/helpdesk_base_template.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<!-- InstanceBeginEditable name="doctitle" -->
<title>AITS Helpdesk: Howto - Remote Access Via Remote Desktop or VNC - </title>
<!-- InstanceEndEditable -->
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Description" content="AITS, Montreal, Canada">
<meta name="keywords" content="AITS, Academic Information Technology Services, Concordia university, Canada, Montreal, ">
<link href="http://www.encs.concordia.ca/Assets/stylesheets/encs.css" rel="stylesheet" type="text/css">
<link href="http://www.encs.concordia.ca/helpdesk/helpdesk.css" rel="stylesheet" type="text/css">
<script language="JavaScript" type="text/JavaScript">
<!--

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}

function MM_reloadPage(init) {  //reloads the window if Nav4 resized
  if (init==true) with (navigator) {if ((appName=="Netscape")&&(parseInt(appVersion)==4)) {
    document.MM_pgW=innerWidth; document.MM_pgH=innerHeight; onresize=MM_reloadPage; }}
  else if (innerWidth!=document.MM_pgW || innerHeight!=document.MM_pgH) location.reload();
}
MM_reloadPage(true);

function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}
//-->
</script>
<!-- InstanceBeginEditable name="head" --><!-- InstanceEndEditable -->
</head>
<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" >
<center>
  <table width="100%" border="0" cellpadding="0" cellspacing="0">
    <tr>
      <td height="21" align="center" bgcolor="#bdb76b"><table cellpadding="0" cellspacing="0" border="0">
          <tr bordercolor="#999999">
            <td width="114"><a href="http://www.encs.concordia.ca/index.htm" onmouseover="MM_swapImage('Image1','','/Assets/images/home2.gif',1)" onmouseout="MM_swapImgRestore()"><img src="http://www.encs.concordia.ca/Assets/images/home1.gif" alt="ENCS Home" name="Image1" width="114" height="21" border="0" id="Image1"></a></td>
            <td width="114"><a href="http://www.encs.concordia.ca/Administration/administration.htm" onmouseover="MM_swapImage('Image9','','/Assets/images/Adminstration2.gif',1)" onmouseout="MM_swapImgRestore()"><img src="http://www.encs.concordia.ca/Assets/images/Adminstration1.gif" alt="Administration" name="Image9" width="114" height="21" border="0" id="Image9"></a></td>
            <td width="114"><a href="http://www.encs.concordia.ca/Alumni" onmouseover="MM_swapImage('Image10','','/Assets/images/Alumni2.gif',1)" onmouseout="MM_swapImgRestore()"><img src="http://www.encs.concordia.ca/Assets/images/Alumni1.gif" alt="Alumni" name="Image10" width="114" height="21" border="0" id="Image10"></a></td>
            <td width="114"><a href="http://www.encs.concordia.ca/Faculty/Departments.htm" onmouseover="MM_swapImage('Image12','','/Assets/images/Departments2.gif',1)" onmouseout="MM_swapImgRestore()"><img src="http://www.encs.concordia.ca/Assets/images/Departments1.gif" alt="Departments" name="Image12" width="114" height="21" border="0" id="Image12"></a></td>
            <td width="114"><a href="http://www.encs.concordia.ca/Research/Research_Unit.htm" onmouseover="MM_swapImage('Image11','','/Assets/images/research2.gif',1)" onmouseout="MM_swapImgRestore()"><img src="http://www.encs.concordia.ca/Assets/images/research1.gif" alt="Research" name="Image11" width="114" height="21" border="0" id="Image11"></a></td>
            <td width="114"><a href="http://www.encs.concordia.ca/News" onmouseover="MM_swapImage('Image13','','/Assets/images/news2.gif',1)" onmouseout="MM_swapImgRestore()"><img src="http://www.encs.concordia.ca/Assets/images/news1.gif" alt="News & Events" name="Image13" width="114" height="21" border="0" id="Image13"></a></td>
            <td width="114"><a href="http://www.encs.concordia.ca/About_ENCS/Jobs.htm" onmouseover="MM_swapImage('Image2','','/Assets/images/jobs2.gif',1)" onmouseout="MM_swapImgRestore()"><img src="http://www.encs.concordia.ca/Assets/images/jobs1.gif" alt="Jobs" name="Image2" border="0" id="Image2"></a></td>
          </tr>
        </table></td>
    </tr>
  </table>
  <table width="100%" border="0" cellpadding="0" cellspacing="0">
    <TR>
      <TD vAlign=top width="100%" bgColor=#bdb76b><DIV align=center>
          <TABLE cellSpacing=0 cellPadding=0 width="100%" align=center border=0>
            <TR>
              <TD vAlign=top bgColor=#FFFFCC><TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                  <TR>
                    <TD bgColor=#666666 colSpan=4 height=1><img src="http://www.encs.concordia.ca/Assets/images/dot.gif" height="1"></TD>
                  </TR>
                  <TR>
                    <TD vAlign=top width=240 bgColor=#FFFFCC ><TABLE cellSpacing=0 cellPadding=0 width=120 border=0>
                        <TR>
                          <TD vAlign=top width=200 bgColor=#FFFFCC><img src="http://www.encs.concordia.ca/Assets/images/ENCS-logo07.gif" border="0" usemap="#Map"> 
                        </TR>
                        <tr>
                          <td height="50"><div align="center">
                              <form method="post" action="http://www.encs.concordia.ca/cgi-bin/htsearch">
                                <font size="1"><strong><font color="#666666">Search Helpdesk:</font></strong></font> <font size="1">
                                <input size="12" name="words" value="" type="text">
                                <input name="restrict" value="www.encs.concordia.ca/helpdesk/" type="hidden">
                                <input value="Go" type="submit">
                                </font> <br>
                                <a href="http://www.encs.concordia.ca/helpdesk/search.html" style="font-size: xx-small">Advanced</a>
                              </form>
                            </div></td>
                        </tr>
                        <TR>
                          <TD vAlign=top width=200 bgColor=#FFFFCC><UL type=circle >
                              <BR>
                              <LI><a href="http://www.encs.concordia.ca/aits">AITS Home</A></LI>
                              <LI><a href="http://www.encs.concordia.ca/Faculty/directory/FA/index.html#AITS">AITS Staff Directory</a></LI>
                              <LI><a href="http://www.encs.concordia.ca/encsit/public/top/archive">Announcement Archive</a></LI>
                              <LI><a href="http://www.encs.concordia.ca/encsit/public/top/sitemap.html">Site Map</a></LI>
                            </UL>
                            <TABLE cellSpacing=0 cellPadding=0 width=240 align=center border=0>
                              <TR>
                                <TD width=100% height=1 bgcolor="#999999"></TD>
                              </TR>
                              <TR>
                                <TD width=100% height=1 bgcolor="#999999"></TD>
                              </TR>
                              <TR>
                                <TD noWrap width=100% bgColor=#AEB96F height=23><DIV align=center><FONT color="#000000" 
                              size=2 face=Verdana,Arial><B>Quick links</B></FONT></DIV></TD>
                              </TR>
                              <TR>
                                <TD height="1" bgcolor="#999999"></TD>
                              </TR>
                              <TR>
                                <TD><!-- ##QUICKLINKS## START -->
                                  <ul>
                                    <br>
                                    <li> <a href="https://fis.encs.concordia.ca/helpdesk-cgi/doorcode.cgi">Lab door codes</a> </li>
                                    <li> <a href="https://fis.encs.concordia.ca/helpdesk-cgi/ch-own-pwd.cgi">Change password</a> </li>
                                    <li> <a href="https://fis.encs.concordia.ca/helpdesk-cgi/quota.cgi">Quota Check </a></li>
                                    <li> <a href="https://mail.encs.concordia.ca/">Webmail </a></li>
                                    <li> <a href="https://fis.encs.concordia.ca/eas">Electronic Assignment Submission</a></li>
                                    <li> <a href="https://fis.encs.concordia.ca/fexch/fexch-description.cgi">File Exchange</a> </li>
                                    <li><a href="http://www.encs.concordia.ca/aits/public/desktop/USER_Managed_Desktop/Windows/HowTo/Install_Sophos_Antivirus/Install_Sophos_Antivirus.html">Sophos Anti-Virus</a></li>
                                    <li><a href="http://www.encs.concordia.ca/helpdesk/access/lab_operation_hours.html">Lab Operation Hours</a></li>
                                    <li><a href="http://www.encs.concordia.ca/aits/public/top/courseSupport.html">Course Support</a></li>
                                    <li><a href="http://www.encs.concordia.ca/aits/software/">Available Softwares </a></li>
                                    <br>
                                  </ul>
                                  <!-- ##QUICKLINKS## END -->
                                </TD>
                              </TR>
                              <TR>
                                <TD width=100% height=1 bgcolor="#999999"></TD>
                              </TR>
                              <TR>
                                <TD noWrap width=100% bgColor=#AEB96F height=23><DIV align=center><FONT color="#000000" 
                              size=1 face=Verdana,Arial><B>Contact the Helpdesk</B></FONT></DIV></TD>
                              </TR>
                              <TR>
                                <TD width="100%" height="1" bgcolor="#999999"></TD>
                              </TR>
                              <TR>
                                <TD width="100%"><table width="220" border="0" align="center">
                                    <tr>
                                      <td><div align="center"> <br>
                                          <strong>Faculty</strong><br>
										  
										  Room: EV 7-182<br>
                                          Phone: 5713<br>
                                                                                   <a href="mailto:facultyhelp@encs.concordia.ca">facultyhelp@encs.concordia.ca</a><br>
                                          <br>
                                          <strong>Student</strong><br>
										  
										  Room: H - 960<br>
                                          Phone: 4181<br>
                                          <a href="mailto:helpdesk@encs.concordia.ca">helpdesk@encs.concordia.ca</a> </div></td>
                                    </tr>
                                  </table></TD>
                              </TR>
                            </TABLE></TD>
                        </TR>
                      </TABLE></TD>
                    <TD vAlign=top width=1 bgColor=#999999 height="100%"><img src="http://www.encs.concordia.ca/Assets/images/dot.gif" width="1"></TD>
                    <TD vAlign=top height="100%"><TABLE width="100%" height="100%" border=0 cellPadding=0 cellSpacing=0 bgcolor="#FFFFCC">
                        <TR>
                          <TD vAlign=top colspan=2><div align="center"><img src="http://www.encs.concordia.ca/encsit/public/top/Assets/images/AITS-header.jpg"></div>
                            <a href="http://www.encs.concordia.ca/helpdesk" style="text-decoration: none">
                            <div style="color: #aeb96f; text-align: center; font-size: 200%; font-weight: 700;">HELPDESK</div>
                            </a> </TD>
                        </TR>
                        <TR>
                          <td height="100%"></TD>
                          <TD class=body  align="left" vAlign=top><TABLE cellSpacing=1 cellPadding=0 width="100%" border=0>
                              <TR>
                                <TD class=content vAlign=top><font size="2"> </font>
                                  <div align="center"> </div>
                                  <!-- add align=center change width from 100% to 90% -->
                                  <TABLE cellSpacing=2 cellPadding=3 width="90%" align=center border=0>
                                    <TR>
                                      <TD class=body vAlign=top width=114></TD>
                                      <TD class=body></TD>
                                    </TR>
                                    <TR>
                                      <TD colspan="2" vAlign=top class=body><div align="justify"><!-- InstanceBeginEditable name="Insert content of the page here" --> 
                                          <h1 align="center">Remote Access Via Remote Desktop </h1> 
                                          <p>Remotely connecting to your user-managed desktop requires a client-server interface, using either Remote Desktop or VNC. Note that the requirements is to have a user-managed machine and Windows 2000/XP or Linux on your client (home) machine. &nbsp;Windows Remote Desktop works best with Windows XP Service Pack 2 although Service Pack 1 or lower will work. If you don't have Service Pack 2 please read in the Remote Desktop section carefully. &nbsp;</p> 
                                          The machine you wish to connect to will need to run either a Remote Desktop or a VNC server and you may need to install a Remote Desktop or VNC client on the client (home) machine you will be working on (i.e. the one you will be using to connect to your user-managed machine). &nbsp; Some of the available software options are to use <span style="font-style: italic">RealVNC, Remote Desktop</span> (Windows&nbsp;only) and/or <span
 style="font-style: italic">TightVNC</span>. Note that Remote Desktop comes with Windows XP.&nbsp;The following page&nbsp;describes the procedures of establishing an SSH Tunnel and connecting&nbsp;the client (home) machine to your&nbsp;user-managed machine.<br> 
                                          <p><span style="font-weight: bold;">Note: </span>Make sure that if your user-managed machine is using a firewall that it is configured to accept connections on the designated port (Default ports are:&nbsp;5900 for VNC and 3390 for Remote Desktop). For more on configuring Windows XP firewall click <a href="http://www.microsoft.com/windowsxp/using/security/internet/sp2_wfintro.mspx" target="_blank">here</a>. <span
 style="font-weight: bold;"></span></p>
                                          <p>On this page, an instruction of how to remotely access to an ENCS user-managed machine will be shown with <strong>Remote Desktop </strong>application.</p>
										  <p>&nbsp;</p>
                                          <h2>On ENCS user-managed machine </h2>
                                          <h3 align="left">1. Configuring </h3>
                                          <p><em>1a. Allow users to connect remotely</em></p>
                                          <p>In other to allow remote access to ENCS user-managed machine, this option has to be enable on this machine</p>
                                          <ul>
                                          <p><strong>In Windows XP</strong></p>										  
										    <li>Right click on 'My Computer' -&gt; Properties. </li>
										    <li>Choose tab 'Remote': Enable option 'Allow users to connect remotely to this computer' </li>
											<p><img src="http://www.encs.concordia.ca/helpdesk/howto/images/remote_access.jpg" width="405" height="458"></p>
											<p>&nbsp;</p>
                                          </ul>
										  
										   <ul>
										   <p><strong>In Windows Vista or Windows 7</strong></p>								   
										     <li>Right click on 'My Computer' -&gt; Properties -&gt;  'Remote settings' </li>
										     <li>On the windows 'System Properties' -&gt; tab 'Remote'
										       <ul>
                                                 <li>check &quot;Allow Remote Assistance connections to this computer&quot;</li>
                                                 <li>choose &quot;Allow connections from computers running any version of Remote Desktop (less secure)&quot;</li>
                                               </ul>
										     </li>
									      </ul>
									      <blockquote>
<p><img src="http://www.encs.concordia.ca/helpdesk/howto/images/remote_access_allow_Vista_Win7_1.jpg" width="197" height="150"></p>
										     <p><img src="http://www.encs.concordia.ca/helpdesk/howto/images/remote_access_allow_Vista_Win7_2.jpg" width="422" height="470"></p>
										     <p>&nbsp;</p>
										     <p>Note: If the above option does not show, registry key needs to be modified manually by </p>
									         <ol>
									           <li>Open Command Prompt as an Administrator, then type 'regedit' (without the single quote)</li>
									           <li> Browse to HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server</li>
									           <li> Set fDenyTSConnections to 0, and create it if necessary. It is set to 1 by default, which disables it. </li>
								             </ol>
										     <p>&nbsp;</p>
									      </blockquote>
										   <h2>On your client (home) machine </h2> 
                                          <h3>1. Installing the remote control application </h3>
                                          <ul>
                                            <li><span style="font-style: italic">Remote Desktop</span> - Windows only&nbsp;application. For installation and&nbsp;configuration click <a href="http://www.microsoft.com/windowsxp/downloads/tools/rdclientdl.mspx" target="_blank">here</a>. Please note the application is pre-installed with Windows XP.</li>
                                          </ul>
                                          <h3>2. Establish SSH tunnel using Putty - Windows </h3>
                                          <p>An SSH tunnel is necessary to ensure secure communication between the two machines. &nbsp; Putty will be used as the SSH client software to establish an SSH tunnel. &nbsp;You can download Putty <a href="http://the.earth.li/%7Esgtatham/putty/latest/x86/putty.exe">here.</a> You don't need to install the program; just save the executable in a convenient place like the Desktop.</p> 
                                          <ol> 
                                            <li> Double-click the icon of Putty on the Desktop to launch it. </li> 
                                            <li> In the Category pane of the application window, select the "Tunnels" option found under Connection-&gt;SSH.</li> 
                                            <li> In the main pane, in the "Port Forwarding" section, do this:
                                              <ol style="list-style-type: lower-alpha;"> 
											  	<li>Checked "Local ports accept connections from other hosts"</li>
											  	<li>Checked "Remote ports do the same (SSH2-only)"</li>
                                                <li> Add the local port that you would like to forward in&nbsp;"Source port". (Default ports are:&nbsp;5900 for VNC and 3390 for Remote Desktop).</li>
                                                <li>In "Destination" type the host name of the machine you are remotely connecting&nbsp;to, followed by a colon and then the port number.</li>
                                              </ol>
                                            </li> 
                                            <li>Click the Add button. </li> 
                                            <li>This is the image of how it should look assuming you're trying to connect to a user-managed machine called venus.encs.concordia.ca:</li> 
                                          </ol> 
                                          <div style="text-align: center;"><img src="http://www.encs.concordia.ca/helpdesk/howto/images/r_d3.jpg" alt="" width="788" height="413" style="width: 788px; height: 413px;"><br> 
                                          </div> 
                                          <ol start="6"> 
                                            <li>In the Category pane, click on "Session" at the top and:
                                              <ol style="list-style-type: lower-alpha;"> 
                                                <li>Enter the <span style="font-style: italic;">hostname</span> of the machine through which you want to establish your tunnel (use <em>login.encs.concordia.ca</em>). </li> 
                                                <li>Select SSH as your protocol. This would set the port number to 22. </li> 
                                              </ol> 
                                            </li> 
                                            <li>Click Save. </li> 
                                            <li>Click Open. If Putty warns you about keys, you can click Okay.</li> 
                                            <li>Enter your ENCS username and password when prompted. </li> 
                                          </ol> 
                                          <p><span style="font-weight: bold;">Note:</span> Next time you do this, you can simply&nbsp;click the <em>Session Name-&gt;Load-&gt;Open</em> to establish the SSH tunnel.&nbsp;</p> 
										  <h3>3. Connecting via the Remote Desktop and Transfer Files</h3>
										  <p>Once you have established the appropriate tunneling&nbsp;you are ready to establish the remote desktop connection. </p>
										  <ol start="1" type="1">
                                            <li>Click Start &gt;&gt; Run &gt;&gt; type mstsc and click OK</li>
										    <li>Enter <em>127.0.0.1:3390</em> in the field <em>Computer</em>. 
<p align="center"><img src="http://www.encs.concordia.ca/helpdesk/howto/images/r_d4.jpg" alt="" width="409" height="239" style="width: 409px; height: 239px;"></p></br> 
<p><strong>Note: </strong>If the OS on the client machine is  other then <strong>Windows XP Service Pack 2</strong> (i.e. Windows XP SP1, Windows 2000,  Vista or windows 7.0), enter 127.0.0.<strong>2</strong>:3390</p>
									        </li>
									        <li>To change your connection settings, (such as screen size, automatic logon       information, transfer and print files), click <em>Options</em> before you connect.</li>
										  </ol>
										  <ol>
										  <ol>
										  <ul>
										    <li><em><strong>Windows vista or 7.0:</strong></em> Click the  Local Resources tab and click on more. Check the Checkbox &quot;Drives&quot; in  the newly opened window and click OK. </li>
										    <li><em><strong>Windows Xp:</strong></em> You&nbsp;will see a  checkbox as Local devices then check the checkbox Disk drives.</li>
										    <li>Click the Connect button to connect  remote computer in the ENCS network. It will warn you about the Disk Drives,  just check don&rsquo;t ask me again and click ok or connect.</li></br>
									      <img src="http://www.encs.concordia.ca/helpdesk/howto/images/r_d5.jpg" alt="" width="820" height="461" style="width: 820px; height: 461px;"></br>
<ol start="4" type="1">
<li>To end the remote session close the window</li>
											 <p><span style="font-weight: bold;">Notes:</span> More information on Windows XP Remote Desktop is available <a href="http://www.microsoft.com/windowsxp/using/mobility/getstarted/remoteintro.mspx" target="_blank">here</a>.
											   </blockquote> 
											   
									         </p>
											 <div style="text-align: center;"><div style="text-align: left;"><blockquote>&nbsp;</blockquote> 
                                            </div> 
                                          </div> 
                                          <!-- InstanceEndEditable --> </div></TD>
                                    </TR>
                                  </TABLE>
                                  <BR>
                                </TD>
                                <TD class=content vAlign=top>&nbsp;</TD>
                              </TR>
                            </TABLE></TD>
                        </TR>
                      </TABLE></TD>
                  </TR>
                </TABLE></TD>
            </TR>
          </TABLE>
          <font color="#FFFFFF" size="1"><strong> If you have any comments about the website please</strong> </font><font size="1"><a href="http://www.encs.concordia.ca/helpdesk/helpdesk.html"><strong>Contact</strong></a></font><font color="#FFFFFF" size="1"> <strong>us</strong></font></DIV></TD>
    </TR>
  </TABLE>
  <div align="right"> <br>
    Copyright &copy; 2005 Faculty of Engineering &amp; Computer Science</div>
  <!--- submenu --->
</center>
<map name="Map">
  <area shape="rect" coords="5,15,235,63" href="../../index.html">
  <area shape="rect" coords="43,67,235,115" href="../../../Documentswww.concordia.ca/">
</map>
</body>
<!-- InstanceEnd --></html>
